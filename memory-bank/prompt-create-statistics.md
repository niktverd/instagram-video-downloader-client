# Инструкция: Как добавить раздел статистики для сущности в проекте React/TypeScript

## 1. Определи API-эндпоинт для статистики

- Убедись, что на бэкенде есть эндпоинт, возвращающий статистику по дням (например, `/ui/get-<entity>-statistics-by-days`).
- Формат ответа: `{ [дата: string]: number }`.
- Если эндпоинта нет — опиши его контракт и добавь на бэкенд.

## 2. Добавь новый маршрут в enum Routes

- В файле с роутами (например, `src/utils/constants.ts`) добавь строку:
  ```ts
  get<Entity>StatisticsByDays = '/ui/get-<entity>-statistics-by-days',
  ```
- Используй правильный путь, совпадающий с бэкендом.

## 3. Проверь/добавь типы для статистики

- В sharedTypes/type/<entity>.ts или аналогичном файле определи:
  ```ts
  export type <Entity>StatisticsParams = z.infer<typeof <Entity>StatisticsParamsSchema>;
  export type <Entity>StatisticsResponse = Record<string, number>;
  ```

## 4. Установи и проверь наличие библиотеки recharts

- Убедись, что в проекте установлен пакет `recharts`:
  ```sh
  npm install recharts
  ```
- Проверь, что нет конфликтов с React-версиями.

## 5. Создай страницу/компонент для статистики

- В директории соответствующей сущности (например, `src/pages/<Entity>/Statistics.tsx`) создай компонент:
  - Используй хуки React (`useState`, `useEffect`, `useCallback`).
  - Импортируй и используй `fetchGet`, `AppEnvContext`, `Routes`.
  - Реализуй функцию для генерации массива дат (например, последние 7/14/30 дней).
  - Фетчи статистику по выбранным дням.

## 6. Нарисуй график с помощью recharts

- Импортируй компоненты из `recharts` (`LineChart`, `Line`, `XAxis`, `YAxis`, `Tooltip`, `CartesianGrid`, `ResponsiveContainer`).
- Построй график по данным из API.
- Добавь кнопки для выбора диапазона (7/14/30 дней) и кнопку Refresh.

## 7. Обработай состояния загрузки и ошибок

- Показывай спиннер при загрузке.
- Показывай ошибку, если запрос не удался.
- Используй `useToaster` для всплывающих сообщений.

## 8. Добавь роут для страницы статистики

- В файле роутера сущности (например, `src/pages/<Entity>/Root.tsx`) добавь:
  ```tsx
  <Route path="/statistics" element={<Statistics />} />
  ```
- Проверь, что страница доступна по `/entity/statistics`.

## 9. Добавь кнопку/ссылку на статистику в основной список

- В компоненте списка (`List.tsx` или аналогичном) добавь кнопку:
  ```tsx
  <Button view="action" href="/entity/statistics">
    Статистика
  </Button>
  ```
- Размести рядом с Refresh или в шапке.

## 10. Проверь интеграцию и UI

- Протестируй переходы между страницами.
- Проверь, что график корректно отображает данные за выбранные периоды.
- Убедись, что ошибки и загрузка обрабатываются корректно.
- Проверь, что код не ломает существующий функционал.

---

> Используй этот шаблон для добавления статистики к любой сущности: просто замени `<Entity>` и пути на нужные.
