# PRD: Instagram Insights Report Page

## Introduction/Overview

Создание страницы для отображения Instagram отчетов с возможностью фильтрации по годам и месяцам, визуализации данных через интерактивные диаграммы и детальным анализом метрик по дням и аккаунтам.

**Цель**: Предоставить пользователям удобный инструмент для анализа Instagram insights с интерактивной визуализацией и гибкими фильтрами.

## Goals

1. Создать интуитивно понятный интерфейс для выбора периода отчета (год/месяц)
2. Реализовать многоуровневую навигацию по данным (день → метрика → аккаунты)
3. Обеспечить интерактивную визуализацию данных через столбиковые диаграммы
4. Предоставить возможность фильтрации аккаунтов для отображения на диаграмме
5. Сохранять состояние фильтров в URL для возможности шаринга и навигации

## User Stories

**Как аналитик**, я хочу выбрать конкретный месяц и год для анализа, чтобы увидеть insights за определенный период.

**Как менеджер**, я хочу просматривать данные по дням, чтобы анализировать динамику показателей во времени.

**Как специалист по соцсетям**, я хочу сравнивать разные метрики (reach, follower_count, online_followers), чтобы понимать эффективность аккаунтов.

**Как аналитик**, я хочу включать и отключать отображение конкретных аккаунтов на диаграмме, чтобы сравнивать их показатели.

**Как пользователь**, я хочу быстро найти нужный аккаунт через поиск, чтобы не листать длинный список.

**Как менеджер**, я хочу, чтобы мои настройки фильтров сохранялись при переключении между датами, чтобы не настраивать их заново.

## Functional Requirements

### 1. Фильтры периода

1.1. Реализовать селектор года в виде радио-кнопок (2025 - текущий год)
1.2. Реализовать селектор месяца в виде радио-кнопок (1-12)
1.3. Значения года и месяца должны записываться в query параметры URL (`?year=2025&month=06`)
1.4. При загрузке страницы парсить query параметры и устанавливать соответствующие значения фильтров
1.5. При изменении фильтров автоматически загружать новые данные

### 2. Структура данных и навигация

2.1. Отображать табы для каждого дня из полученных данных
2.2. Внутри каждого дня отображать табы для каждой метрики (reach, follower_count, online_followers)
2.3. Активный день и метрика должны сохраняться в query параметрах (`?day=2025-06-14&metric=reach`)

### 3. Визуализация данных

3.1. Использовать библиотеку recharts для создания столбиковой диаграммы
3.2. Отображать данные выбранной метрики по аккаунтам
3.3. По умолчанию показывать только значение "total"
3.4. Использовать единый цвет для всех столбцов диаграммы
3.5. Диаграмма должна быть responsive и адаптироваться под разные размеры экрана

### 4. Управление аккаунтами

4.1. Отображать список чекбоксов под диаграммой для каждого аккаунта
4.2. Позволять включать/отключать отображение аккаунтов на диаграмме
4.3. Состояние чекбоксов записывать в query параметр (`?accounts=total,account1,account2`)
4.4. Чекбокс "total" должен быть выбран по умолчанию

### 5. Поиск и фильтрация

5.1. Реализовать поле ввода для поиска аккаунтов
5.2. Поиск должен быть регистронезависимым и работать по частичному совпадению
5.3. Фильтровать чекбоксы в реальном времени при вводе текста
5.4. Сохранять значение поиска в query параметре (`?search=account_name`)

### 6. API интеграция

6.1. Использовать эндпоинт `/ui/get-insights-report?year=YYYY&month=MM`
6.2. Парсить ответ согласно схеме `UiGetInsightsInstagramReportResponseSchema`
6.3. Обрабатывать состояния загрузки, успеха и ошибки

### 7. Обработка состояний

7.1. Показывать "Loading..." во время загрузки данных
7.2. Отображать заглушку при отсутствии данных за выбранный период
7.3. Показывать сообщение об ошибке при неудачном запросе

## Non-Goals (Out of Scope)

- Экспорт данных в файлы (CSV, Excel)
- Редактирование или удаление данных
- Сравнение данных между разными периодами
- Уведомления или алерты
- Детальная настройка внешнего вида диаграмм
- Сохранение настроек в localStorage (только query параметры)

## Design Considerations

- Использовать компоненты Gravity UI для единообразия дизайна
- Компоненты для использования:
  - `RadioGroup` для селекторов года и месяца
  - `Tabs` для навигации по дням и метрикам
  - `TextInput` для поиска аккаунтов
  - `Checkbox` для управления отображением аккаунтов
  - `Alert` для сообщений об ошибках
  - `Progress` или `Spin` для индикации загрузки
- Расположение элементов: фильтры сверху, табы посередине, диаграмма и чекбоксы снизу
- Responsive дизайн для мобильных устройств

## Technical Considerations

- Следовать структуре из Structure_new.md для организации компонентов
- Использовать React Query для кэширования данных
- Реализовать debounce для поискового поля (300ms)
- Использовать React Router для управления query параметрами
- Валидировать входящие данные согласно зod-схеме
- Компоненты должны быть типизированы с TypeScript

## Success Metrics

- Время загрузки страницы не превышает 2 секунд
- Пользователи могут успешно переключаться между периодами без потери настроек
- Поиск аккаунтов работает мгновенно (< 100ms)
- Диаграмма корректно отображается на экранах от 320px до 1920px

## Open Questions

1. Нужно ли добавить возможность выбора нескольких месяцев одновременно?
2. Следует ли добавить сортировку аккаунтов в списке чекбоксов?
3. Требуется ли добавить tooltip'ы с дополнительной информацией на диаграмму?
4. Нужно ли ограничивать максимальное количество одновременно отображаемых аккаунтов?
